## 化学反应动力学机理简化过程中的不确定性传递

[TOC]

> ​	化学反应机理简化是将详细反应机理应用于实际湍流燃烧模拟的必要手段，现有的机理简化通常仅考虑与详细机理预测值的一致性，而不考虑与详细机理的预测值不确定性的一致性。本课题将使用不确定性分析方法来研究机理简化对反应机理的前向不确定性传递的影响，以及借鉴机器学习中正则化思想发展一种既简化又能够准确预测实验数据的机理简化方法，用到的不确定性分析方法主要包括蒙特卡洛方法/反应面模型/和Bayes参数优化。

### 一、开题准备

+ 学习软件
  + Chemkin反应动力学相关部分手册 Tutorial 中着火延迟时间和层流火焰传播速度
  + `Cantera` 资料，点火延迟时间、火焰传播速度

+ 学习理论
  + 反应动力学【资料、书】Combustion Physics反应动力学
  + 机理简化 DRG 主要是 Tianfeng Lu 老师的几篇文章
  + 不确定性【博士论文、书、文献】Braman, Kalen, Todd A. Oliver, and Venkat Raman. "Bayesian analysis of syngas chemistry models." *Combustion Theory and Modelling* 17.5 (2013): 858-887.
  + 贝叶斯的基本原理，叶斯视角下的正则化、Bayes factor、MCMC

+ 一些资源
  + [DRG python代码](https://github.com/Niemeyer-Research-Group/pyMARS)
  + [MUM-PCE](https://github.com/usnistgov/mumpce_py)
  + [Stanford FFCM1](https://web.stanford.edu/group/haiwanglab/FFCM1/pages/trialrates.html)

### 二、思路整理

+ 化学反应动力学

  + 反应速率：化学反应快慢的量度，反应的物质的量随时间的导数。本研究主要关系 Arrhenius 假设下的反应。
  $$
  k=AT^n\exp(-\frac{Ea}{RT})
  $$

  + 反应机理：化学反应是分多步完成的，描述化学反应的微观过程称为反应机理，通常包括一系列基元反应。

+ 机理简化

  + 过程：用敏感性分析、DRG等方法，将复杂的机理简化掉一些物质和反应，得到较小且相对准确的机理。
  + 意义：反应路径的复杂性高，尤其是低温、高压机理反应，机理简化可以大大减小反应计算量。

+ 化学反应动力学的不确定性

  + 在同一工况下，实验得到的反应特征参数如点火延迟时间并不完全可重复，而是呈现一定的散布规律。（假设如高斯分布）
  + 动力学数据如反应系数存在不可靠性，通过存在不确定性的实验数据构造出来的机理也存在其不确定性，即每个参数有一定的不确定范围。

  $$
  x = [k_1, \cdots, k_n] \,\,  \text{n reaction}\\
  k_i\in (k_{i,min},k_{i,max}), i=1,\cdots,n
  $$

  + 而通过对确定的一组参数范围进行采样(eg. 蒙特卡洛采样)，可以得到一系列的反应机理参数，从而通过模拟可以得到一系列反应特征参数(eg. 点火延迟时间)。
  + 比对试验的分布和模拟的分布，可以定量的评估此参数范围的质量，而不断修改参数分布范围，理论上可以得到最佳的参数分布，满足其不确定性与实验不确定性相一致。
  + 但由于实验数据的有限性，一般不能对同一工况进行上述操作，而是在一系列工况下进行采样与比较，加大了问题的复杂度。

+ 机理简化过程中的不确定性传递

  + 对一个已知其[最佳]参数分布的机理，进行简化后，其子机理的分布对应的模拟结果与实验值分布存在差异，即机理简化过程对不确定性分布产生了影响，而简化过程如何对不确定性的影响即为机理简化过程中的不确定性传递。

+ Active Subspace

  + 敏感性：一个机理中，反应参数变化一定值后，所得特征结果变化的大小与反应参数变化之比即为敏感性，表征了反应的重要性。
  + 反应敏感性：一个机理的所有反应在一个工况下的敏感性可表达为一个向量，其方向代表了各个基向量的权重大小(各个反应的重要程度)

  $$
  Rsens = [s_1, \cdots, s_n], \,\, \text{n reaction}
  $$

  + 计算一系列不同工况下的反应敏感性可得到反应敏感性的高维分布，其分布若存在低维子空间，即各工况下的向量在此子空间的投影长度基本一致，代表子空间内的维度比其以外的维度更重要，即子空间对应的一系列反应（或反应的线性组合）在不同工况下的敏感性变化较大。
  + 参数化求解一个机理（及其不确定性）时，通常需要不断修改反应系数并模拟计算，以期得到正确的机理（及其不确定性）。但在知道低维子空间时，需要的调整、计算量将大大减少。

+ 响应面模型如何使用？

+ 核心研究问题：机理简化过程中的不确定性传递（变大、变小、不变？）

+ 工作量：计算机理简化过程前后的不确定性

  分析：尝试回答机理简化后不确定性传递的变化

  需要的工具：怎么做不确定性传递(蒙特卡洛、PCE)

  机理简化过程中，不确定性变化和敏感性变化的相关性

  不确定性优化：使用MUM-PCE, 可用 active subspace 和 sensitivity subspace 减少搜索空间



### 二、操作流程

+ 机理简化（Mechanism Reduction）：将详细机理（DME / JP-10）通过 DRG / SA 等方法进行简化，得到一系列简化机理

  + 通过 PyMARS 的 DRG 功能计算一系列 threshold 对应的机理大小和误差error，在误差发生较大突变前的位置选取简化机理，一般选取 3-4 个（多工况下）【与 Chemkin 进行对比验证】

  + 对选取的机理进行基本验证，画出其在一系列工况下与详细机理的 QoI (IDT / Su / ESR) 误差，如：

    ![detailed and reduced](/Users/suxy/学习/9-其他/毕业设计/pic/detailed and reduced.png)

+ 不确定性计算（Uncertainty Quantification）：对一个反应数为 n 的机理

  + 系数空间内的采样与敏感性计算

    + 每个反应的系数有其不确定性，在系数空间内得到一系列样本，计算对应的 QoI (如$\tau$)，及其敏感性
    + 其中，$\tau$ 的敏感性可通过温度敏感性计算

  + 构建子空间（Active Subspace）

    + **法1: 全局线性拟合（Global Liner Fitting）**，一系列系数组合 $x (k \times n)$ 对应的 QoI (如 $\log(\tau) (k\times 1)$) 做线性拟合，拿到拟合参数 $W (1\times n)$ 和 $b$ ，简单且只适用于一维
      $$
      \log(\tau)=xW^T+b
      $$

    - **法2: Active Subspace**，通过 $x$ 空间内的采样来构建响应空间，通过特征值分解确定低维子空间，通过 Summary Plot 验证其性质好坏

  + 构建响应面模型（Response Surface）：在子空间内构建响应面模型

    + 以子空间为一维为例，将 $x (k \times n)$ 映射到子空间得到的变量为一维$s (k \times 1)$，建立其到 $\log(\tau)$  的多项式关系
      $$
      \log(\tau) = a_0 + a_1s + a_2 s^2 + \cdots
      $$

    + 当维度大于等于 2 时，可使用 PCE (Polynomial Chaos Expansion) 方法，将 $x (k \times n)$ 映射到子空间得到的变量为 m 维 $s (k \times m)$ ，有：
      $$
      log(\tau) = a_0 + \sum_{i=1}^m a_{i} s_i + \sum_{i=1}^m\sum_{j\ge i}^m b_{i,j} s_is_j + \cdots
      $$

    + 当 m 维映射为简单的通过敏感性分析取出最重要的 m 维 (10-30) 时，$a_i$ 和 $b_{i,j}$ 可通过一二阶敏感性取得

  + 蒙特卡洛采样，计算不确定性

    + 对 $x$ 在系数不确定性范围内进行大量采样 (50000+)，对每一个样本通过响应面函数得到 QoI (如 $\log (\tau)$)，计算 QoI 的方差得到机理的不确定性

+ 不确定性传递分析（Uncertainty Propagation）

  + 根据结果找到基本规律/异常
    + sk42 与 zhao 基本重合，sk30 不确定性整体偏低
    + 高温时各机理不确定性基本一致
    + 压力越大，差异有越明显的趋势
    + 低温时有异常现象发生，不确定性开始减小，sk30不确定性增大
  + 分析规律/异常
    + 通过Active Subspace



> 100+ CPU hour
>
> 增加 DMEsk40/DMEsk2?
>
> 